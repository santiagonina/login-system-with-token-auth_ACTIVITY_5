using System;

class Program
{
    // A 2D array to store usernames and passwords
    static string[,] users = new string[,] {
        { "Admin", "admin123" },
        { "User", "password123" }
    };

    static string token = null;

    static void Main(string[] args)
    {
        while (true)
        {
            ShowMainMenu();
            string choice = Console.ReadLine();

            switch (choice)
            {
                case "1":
                    Login();
                    break;
                case "2":
                    GlobalCheck();
                    break;
                case "3":
                    AuthorizationCheck();
                    break;
                case "4":
                    Logout();
                    break;
                default:
                    Console.WriteLine("Invalid choice. Please try again.");
                    break;
            }
            Console.WriteLine();
        }
    }

    static void ShowMainMenu()
    {
        Console.WriteLine("Welcome! Choose an option:");
        Console.WriteLine("1. Login");
        Console.WriteLine("2. Global Check (String Exercises)");
        Console.WriteLine("3. Authorization Check");
        Console.WriteLine("4. Logout");
        Console.Write("Enter your choice: ");
    }

    //Login System
    static void Login()
    {
        int attempts = 3;
        while (attempts > 0)
        {
            Console.Write("\nEnter Username: ");
            string username = Console.ReadLine();
            Console.Write("Enter Password: ");
            string password = Console.ReadLine();

            bool isAuthenticated = false;
            string foundPassword = "";

            // Loop through the 2D array to find a match
            for (int i = 0; i < users.GetLength(0); i++)
            {
               
                if (username.Equals(users[i, 0], StringComparison.OrdinalIgnoreCase))
                {
                    if (password == users[i, 1])
                    {
                        isAuthenticated = true;
                        foundPassword = users[i, 1];
                        break;
                    }
                }
            }

            if (isAuthenticated)
            {
                Console.WriteLine("Login Successful!");
                // Generate the token by reversing the password and adding it to the username.
                char[] charArray = foundPassword.ToCharArray();
                Array.Reverse(charArray);
                string reversedPassword = new string(charArray);
                token = reversedPassword + username;
                Console.WriteLine($"Generated Token: {token}");
                return;
            }
            else
            {
                attempts--;
                Console.WriteLine($"Login Failed. You have {attempts} attempts remaining.");
                if (attempts == 0)
                {
                    Console.WriteLine("You have been locked out after 3 failed tries.");
                    Environment.Exit(0);
                }
            }
        }
    }

    //Global Check (String Exercises)
    static void GlobalCheck()
    {
        while (true)
        {
            Console.WriteLine("\nWelcome to the Global Check!");
            Console.WriteLine("Choose an activity:");
            Console.WriteLine("1. Reverse a sentence");
            Console.WriteLine("2. Search for a word in a paragraph");
            Console.WriteLine("3. Go back to the main menu");
            Console.Write("\nEnter your choice: ");
            string choice = Console.ReadLine();

            switch (choice)
            {
                case "1":
                    ReverseSentence();
                    break;
                case "2":
                    SearchWord();
                    break;
                case "3":
                    Console.WriteLine("Returning to the main menu...");
                    return;
                default:
                    Console.WriteLine("Invalid choice. Please try again.");
                    break;
            }
        }
    }

    static void ReverseSentence()
    {
        Console.Write("Enter a sentence: ");
        string sentence = Console.ReadLine();
        string[] words = sentence.Split(' ');
        Array.Reverse(words);
        string reversedSentence = string.Join(" ", words);
        Console.WriteLine($"Reversed sentence: {reversedSentence}");
    }

    static void SearchWord()
    {
        string paragraph = "C# is a powerful programming language. It is widely used for building various applications, including web, mobile, and desktop apps.";
        Console.WriteLine($"Predefined paragraph: {paragraph}");
        Console.Write("Enter a word to search for: ");
        string word = Console.ReadLine();
       
        if (paragraph.Contains(word, StringComparison.OrdinalIgnoreCase))
        {
            Console.WriteLine($"The word '{word}' was found in the paragraph.");
        }
        else
        {
            Console.WriteLine($"The word '{word}' was not found in the paragraph.");
        }
    }

    //Authorization Check
    static void AuthorizationCheck()
    {
        if (token != null)
        {
            Console.WriteLine("\nYou're currently viewing this page as an authorized user.");
        }
        else
        {
            Console.WriteLine("\nUnauthorized view. Please log in to access this page.");
        }
    }

    static void Logout()
    {
        Console.WriteLine("\nLogging out...");
        token = null;
        Console.WriteLine("Token cleared.");
    }
}
